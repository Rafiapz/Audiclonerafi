/*! For license information please see model-band.js.LICENSE.txt */
/* nemo-home v125.0.0 */
window["model-band"]=function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,t){e.exports=window["core-utils"]},,function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return s}));var n=i(0);function r(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}Object.setPrototypeOf(r.prototype,HTMLElement.prototype),Object.setPrototypeOf(r,HTMLElement);class s extends r{constructor(){super()}connectedCallback(){this._initializeModule()}disconnectedCallback(){window.removeEventListener("resize",n.dom.throttle(this._resizeModule.bind(this),50)),window.removeEventListener("scroll",n.dom.throttle(this._scrollHandler.bind(this),100))}_initializeModule(){this._oDefaults={selectorContainerWrap:".nm-model-band-container",selectorContainerItem:".nm-model-band-container-item",selectorEecContainer:".nm-model-band-eec-explanation",selectorStripeContainer:".nm-model-band-stripe-container",selectorStripe:".nm-model-band-stripe",selectorStripeItem:".nm-model-band-stripe-item",classContainerIsOpen:"nm-j-model-band-container-is-open",classContainerSticky:"nm-j-model-band-container-sticky",classContainerItemVisible:"nm-model-band-container-item-visible",classHidePrevArrow:"nm-j-model-band-hide-prev-arrow",classHideNextArrow:"nm-j-model-band-hide-next-arrow"},this._scrollDuration=500,this.stripes=this.querySelectorAll(this._oDefaults.selectorStripe),this.stripeItems=this.querySelectorAll(this._oDefaults.selectorStripeItem),this.navigationItems=this.querySelectorAll(".nm-model-band-tab-navigation li"),this.prevButtons=this.querySelectorAll(".nm-model-band-stripe-prev"),this.nextButtons=this.querySelectorAll(".nm-model-band-stripe-next"),this.defaultInputs=this.querySelectorAll(".nm-model-band-default-input"),this._reset(),this._addEvents(),this._resizeModule(),this._setContainerItemHeight(),this._handleNavigationArrows(),this._addAriaTags()}_reset(){this._resetInputs(),this._resetItems()}_resetInputs(){[...this.querySelectorAll(".nm-model-band-input")].forEach(e=>{e.checked=!1}),[...this.defaultInputs].forEach(e=>{e.checked=!0})}_resetItems(){const e=this.querySelector(this._oDefaults.selectorContainerWrap),t=this.querySelectorAll(this._oDefaults.selectorContainerItem);e.classList.remove(this._oDefaults.classContainerIsOpen),e.style.height="0px",[...t].forEach(e=>{e.style.height="0px",e.classList.remove(this._oDefaults.classContainerItemVisible)})}_addEvents(){window.addEventListener("resize",n.dom.throttle(this._resizeModule.bind(this),50)),window.addEventListener("scroll",n.dom.throttle(this._scrollHandler.bind(this),100)),[...this.stripes].forEach(e=>{e.addEventListener("scroll",this._handleNavigationArrows.bind(this))}),[...this.navigationItems].forEach(e=>{e.addEventListener("click",this._handleNavItemClick.bind(this))}),[...this.stripeItems].forEach(e=>{e.addEventListener("click",this._handleStripeItemClick.bind(e,this))}),[...this.defaultInputs].forEach(e=>{e.addEventListener("click",this._resetItems.bind(this))}),[...this.prevButtons].forEach(e=>{e.addEventListener("click",this._handlePrevNextClick.bind(e,this))}),[...this.nextButtons].forEach(e=>{e.addEventListener("click",this._handlePrevNextClick.bind(e,this))})}_resizeModule(){const e=this.querySelector(this._oDefaults.selectorStripeContainer),t=this._getVisibleStripe();e.classList.remove("nm-model-band-stripe-container-hidden"),t&&(this._setContainerItemHeight(),this._handleNavigationArrows())}_setContainerItemHeight(){const e=this.querySelectorAll(".nm-model-band-container-models "+this._oDefaults.selectorContainerItem),t=this.querySelectorAll(".nm-model-band-stripe-models-wrap "+this._oDefaults.selectorStripeItem),i=this.querySelectorAll(".nm-model-band-container-types "+this._oDefaults.selectorContainerItem),n=this.querySelectorAll(".nm-model-band-stripe-types-wrap "+this._oDefaults.selectorStripeItem);[...e].forEach((e,i)=>{let n=this._getItemHeight(e);t[i].setAttribute("data-height",n),e.setAttribute("data-height",n)}),[...i].forEach((e,t)=>{let i=this._getItemHeight(e);n[t].setAttribute("data-height",i),e.setAttribute("data-height",i)})}_handleNavigationArrows(){[...this.stripes].forEach(e=>{let t=n.dom.closest(e,".nm-model-band-stripe-wrap"),i=e.querySelector("ul").getBoundingClientRect().width-e.getBoundingClientRect().width;e.scrollLeft<=10?(t.classList.add(this._oDefaults.classHidePrevArrow),t.classList.remove(this._oDefaults.classHideNextArrow)):e.scrollLeft<i-10?(t.classList.remove(this._oDefaults.classHideNextArrow),t.classList.remove(this._oDefaults.classHidePrevArrow)):(t.classList.add(this._oDefaults.classHideNextArrow),t.classList.remove(this._oDefaults.classHidePrevArrow))})}_addAriaTags(){this.stripes.forEach(e=>e.setAttribute("aria-expanded",!1)),this._getVisibleStripe()&&this._getVisibleStripe().setAttribute("aria-expanded",!0);this.navigationItems.forEach(e=>{e.setAttribute("aria-selected",!1);const t=e.querySelector("label"),i=t.getAttribute("for");document.querySelector("#"+i).checked&&t.parentElement.setAttribute("aria-selected",!0)})}_scrollHandler(){const e=this.querySelector(this._oDefaults.selectorContainerWrap),t=n.dom.getElementsAbsoluteTopPosition(e),i=e.querySelector(this._oDefaults.selectorEecContainer),r=i?i.scrollHeight:0,s=this.querySelector("."+this._oDefaults.classContainerItemVisible);let o=0;if(s){o=s.querySelector(".nm-model-band-container-headline").scrollHeight;const i=t+e.clientHeight-r-o;e.classList.contains(this._oDefaults.classContainerIsOpen)&&window.pageYOffset>t&&window.pageYOffset<i?(e.classList.add(this._oDefaults.classContainerSticky),s.style.paddingTop=o+"px"):(e.classList.remove(this._oDefaults.classContainerSticky),s.style.paddingTop="0px")}}_handleNavItemClick(){this._getVisibleStripe().scrollLeft=0,this._reset();let e=this;setTimeout((function(){e._setContainerItemHeight(),e._handleNavigationArrows(),e._addAriaTags()}),100)}_showOrHideStripeItems(e,t,i,n){e.forEach(e=>{e.closest(".nm-model-band-stripe-item").classList.contains(`nm-model-band-stripe-${t}-item${i}`)?e.style.display=n?"none":"block":e.style.display=n?"block":"none"})}_updateActiveCarView(e,t,i){if(e&&void 0===t.dataset.loadingImage){const n=t.querySelector(".nm-model-band-stripe-img-active"),r=e.querySelectorAll(".nm-model-band-stripe-img"),s=e.querySelectorAll(".nm-model-band-stripe-img-active"),o=e.dataset.id,l=t.dataset.index;if(n){const a=e.querySelector(`input.nm-model-band-${i}-input.nm-model-band-${o}-${i}-${l}`);a&&a.checked?(t.dataset.loadingImage="1",n.addEventListener("load",()=>{delete t.dataset.loadingImage,this._showOrHideStripeItems(r,i,l,!0),this._showOrHideStripeItems(s,i,l,!1)},{once:!0}),n.setAttribute("src",n.getAttribute("data-src")),n.setAttribute("loading","eager")):(s.forEach(e=>{e.style.display="none"}),r.forEach(e=>{e.style.display="block"}))}}}_handleStripeItemClick(e){const t=this;let i=e._getCurrentInputType(t);setTimeout((function(){e._updateActiveCarView(e,t,i)}),0),setTimeout((function(){if(e.querySelector(".nm-model-band-"+i+"-input:checked"))e._loadDynamicModelData(e,t,i).then((function(i){e._replaceDynamicContent(e,t,i)})).catch((function(e){console.error("Error while reading layer template",e)}));else{const t=e.querySelector(e._oDefaults.selectorContainerWrap),i=t.querySelectorAll(".nm-model-band-container > ul")[e._getVisibleStripeIndex()].querySelectorAll(e._oDefaults.selectorContainerItem);e._resetContainerHeight(e,t,i)}}),0)}_replaceDynamicContent(e,t,i){const n=e,r=n._getCurrentInputType(t),s=n.querySelector(n._oDefaults.selectorContainerWrap),o=s.querySelectorAll(".nm-model-band-container > ul")[n._getVisibleStripeIndex()].querySelectorAll(e._oDefaults.selectorContainerItem);let l=e.querySelector(".nm-model-band-"+r+"-input:checked");const a=parseInt(l.dataset.index,10),c=s.querySelector("ul.nm-model-band-container-"+r);c&&(n._resetContainerHeight(e,s,o),c.innerHTML=i,n._fixCloseButton(e,s,t),n._fixHeight(e,s,t,a))}_fixHeight(e,t,i,r){const s=e,o=s._getCurrentInputType(i),l=t.querySelector("ul.nm-model-band-container-"+o);t.classList.add(e._oDefaults.classContainerIsOpen);const a=l.querySelector(".nm-model-band-container-item");s._setCurrentContainerItemHeight(a);const c=s._getItemHeight(a);t.style.height=c+"px",s._handleStripeAnimation(i,r),n.dom.scrollTo(n.dom.getElementsAbsoluteTopPosition(e),200)}_fixCloseButton(e,t,i){const n=e,r=n._getCurrentInputType(i),s=t.querySelector("ul.nm-model-band-container-"+r).querySelector(".nm-model-band-container-close-button"),o=e.querySelector(`.nm-model-band-default-input.nm-model-band-${r}-default`);s&&o&&(s.setAttribute("for",o.id),s.addEventListener("click",()=>{setTimeout(()=>{n._updateActiveCarView(e,i,r)},0)}))}_resetContainerHeight(e,t,i){t.classList.contains(e._oDefaults.classContainerIsOpen)&&[...i].forEach(t=>{t.style.height=0,t.classList.remove(e._oDefaults.classContainerItemVisible)})}_loadDynamicModelData(e,t,i){return new Promise((n,r)=>{const s=window.location.pathname.lastIndexOf("."),o=window.location.pathname.substring(0,s),l=t.dataset.category,a=e.dataset.resourcepath,c=o+".model_band_dynamic."+("models"===i?"carlinegroup":"bodytype")+"."+l+".html?resourcePath="+encodeURIComponent(a);fetch(c,{headers:{Accept:"text/plain"},method:"GET"}).then((function(e){if(e.ok)return e.text();throw new Error(e.error)})).then((function(e){n(e)})).catch((function(e){console.error("Error while loading dynamic model band data",e),r(e)}))})}_handleStripeAnimation(e,t){const i=n.dom.closest(e,this._oDefaults.selectorStripe),r=n.dom.closest(e,this._oDefaults.selectorStripeContainer).clientWidth,s=e.clientWidth,o=t*s-r/2+s/2,l=this._calculateScrollDuration(r,i.scrollLeft,o);n.dom.animateElementX(o,i,l)}_setCurrentContainerItemHeight(e){e.style.height="auto",e.classList.add(this._oDefaults.classContainerItemVisible)}_handlePrevNextClick(e){let t="next";this.classList.contains("nm-model-band-stripe-prev")&&(t="prev"),e._translateStripe(e,t)}_translateStripe(e,t){const i=e.querySelector(e._oDefaults.selectorStripeContainer),r=e._getVisibleStripe();if(r.querySelector(".nm-model-band-stripe > ul").clientWidth>i.clientWidth){const s=e._calculateNewScrollPosition(i.clientWidth,r.scrollLeft,t,r),o=e._calculateScrollDuration(i.clientWidth,r.scrollLeft,s);n.dom.animateElementX(s,r,o)}}_calculateScrollDuration(e,t,i){return this._scrollDuration*(Math.abs(t-i)/e)}_calculateNewScrollPosition(e,t,i,n){const r=this._getVisibleItems(n);let s,o;return"next"===i?(o=this._getNewIndex(r[r.length-1]),s=this._getItemWidth(r[r.length-1])*o):s=t-(e-this._getRightBound(r[0])),s}_getItemHeight(e){const t=this.querySelector(this._oDefaults.selectorEecContainer),i=t?t.scrollHeight:0;return e.querySelector(".nm-model-band-container-item-inner").scrollHeight+i}_getVisibleStripe(){const e=this.querySelectorAll(this._oDefaults.selectorStripe);let t=null;return[...e].forEach(e=>{"block"===window.getComputedStyle(e.parentNode,null).getPropertyValue("display")&&(t=e)}),t}_getVisibleStripeIndex(){const e=this.querySelectorAll(this._oDefaults.selectorStripe);let t=null;return[...e].forEach((e,i)=>{"block"===window.getComputedStyle(e.parentNode,null).getPropertyValue("display")&&(t=i)}),t}_getCurrentInputType(e){const t=e.parentNode.classList[0].split("-");return t[t.length-1]}_getVisibleItems(e){const t=e.querySelectorAll(this._oDefaults.selectorStripeItem);let i=[];return[...t].forEach(t=>{n.dom.isVisible(t,e,!1)&&i.push(t)}),i}_getNewIndex(e){return e.getAttribute("data-index")||0}_getItemWidth(e){return e.clientWidth||0}_getRightBound(e){return e.getBoundingClientRect().right||0}}void 0===window.customElements.get("audi-model-band")&&window.customElements.define("audi-model-band",s)}]);
//# sourceMappingURL=model-band.js.map